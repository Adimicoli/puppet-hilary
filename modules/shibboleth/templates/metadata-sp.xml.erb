<!-- Metadata file for the service provider -->
<md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" ID="_6494bd01f471ef997d27d44d505aa120b1ce0549" entityID="<%= entity_id %>">
    <!-- The SP description -->
    <md:SPSSODescriptor protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol">
        <!-- The key that is used by this SP -->
        <md:KeyDescriptor>
            <ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
                <ds:KeyName><%= keyname %></ds:KeyName>
                <ds:X509Data>
                    <ds:X509SubjectName><%= subjectname %></ds:X509SubjectName>
                    <ds:X509Certificate><%= certificate %></ds:X509Certificate>
                </ds:X509Data>
            </ds:KeyInfo>
        </md:KeyDescriptor>

        <!-- All the hostnames this SP covers -->
        <% @shibboleth_hosts.keys.sort.each_with_index do |key, index| -%>
            <md:AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="https://<%= shibboleth_hosts[key]['hostname'] %>/Shibboleth.sso/SAML2/POST" index="<%= index %>"/>
        <% end -%>
    </md:SPSSODescriptor>

    <!-- Human-readable information about our SP and who should be contacted -->
    <md:Organization>
        <md:OrganizationName xml:lang="en">Research Research</md:OrganizationName>
        <md:OrganizationDisplayName xml:lang="en">Open Academic Environment</md:OrganizationDisplayName>
        <md:OrganizationURL xml:lang="en">http://oaeproject.org</md:OrganizationURL>
    </md:Organization>
    <md:ContactPerson contactType="technical">
        <md:GivenName>Steve</md:GivenName>
        <md:SurName>Potter</md:SurName>
        <md:EmailAddress>sp@researchresearch.com</md:EmailAddress>
    </md:ContactPerson>
</md:EntityDescriptor>
